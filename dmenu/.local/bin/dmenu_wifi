#!/bin/bash

#
# dmenu script to show and connect to wifi networks
# 


source "${XDG_CONFIG_HOME:-$HOME/.config}/dmenu/dmenu-themes"

choice=$(nmcli -f BARS,SECURITY,SSID device wifi list          | # show networks
         awk '(NR>1) {$2=="--"?$2="  ":$2="  "; print}'      | # format input
         dmenu -i "${DMENU_CENTER[@]}" "${DMENU_WAL_THEME[@]}" | # dmenu command
         awk '{$1=$2=""; print}')                                # format output

if [[ ! -z "$choice" ]] ; then

  nmcli dev wifi connect "$choice"                               # connect

  if [[ "$?" > 0 ]] ; then
    notify-send "Non è stato possibile connettersi"
  else
    notify-send "Connessione a $choice riuscita"
  fi

fi

